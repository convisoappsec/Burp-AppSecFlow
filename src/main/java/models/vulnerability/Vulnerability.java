package models.vulnerability;

import org.apache.http.HttpEntity;
import org.apache.http.entity.ContentType;
import org.apache.http.entity.mime.MultipartEntityBuilder;
import utilities.Util;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.ArrayList;

public class Vulnerability {

    private int analysisId;//": 2188,                   //OBRIGATORIO
    private int vulnerabilityTemplateId;//": 1,          //OBRIGATORIO

    private String impact;//": "medium",                //OBRIGATORIO
    private String probability;//": "medium",           //OBRIGATORIO

    private String description;//": "client_impact",  //OBRIGATORIO
    private String impactResume;//": "impact resume", "
    private boolean notification;

    private String webProtocol;//": "",
    private String webMethod;//": "",
    private String webUrl;//": "",
    private String webParameters;//": "",
    private String webSteps;//": "",
    private String webRequest;//": "",
    private String webResponse;//": "",
    private Boolean invaded;//": true
    private String invadedEnvironmentDescription;//": "invaded environment description",
    private ArrayList<Evidence> vulnerabilityArchives;
    private String clienteMutationId; // added on migration to graphql



    public Vulnerability(){

    }

    public Vulnerability(int analysisId, int vulnerabilityTemplateId, String impact, String probability, Boolean invaded,
                         String invadedDescription, String description, String impactResume, String webProtocol,
                         String webMethod, String webUrl, String webParameters,
                         String webSteps, String webRequest, String webResponse) {

        this.analysisId = analysisId;
        this.vulnerabilityTemplateId = vulnerabilityTemplateId;
        this.impact = impact;
        this.probability = probability;
        this.description = description;
        this.impactResume = impactResume;
        this.webProtocol = webProtocol;
        this.webMethod = webMethod;
        this.webUrl = webUrl;
        this.webParameters = webParameters;
        this.webSteps = webSteps;
        this.webRequest = webRequest;
        this.webResponse = webResponse;
        this.invaded = invaded;
        this.invadedEnvironmentDescription = invadedDescription;
        this.vulnerabilityArchives = new ArrayList<>();
    }

    public void setAnalysisId(int analysisId) {
        this.analysisId = analysisId;
    }

    public void setVulnerabilityTemplateId(int vulnerabilityTemplateId) {
        this.vulnerabilityTemplateId = vulnerabilityTemplateId;
    }

    public void setImpact(String impact) {
        this.impact = impact;
    }

    public void setProbability(String probability) {
        this.probability = probability;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public void setImpactResume(String impactResume) {
        this.impactResume = impactResume;
    }

    public void setWebProtocol(String webProtocol) {
        this.webProtocol = webProtocol;
    }

    public void setWebMethod(String webMethod) {
        this.webMethod = webMethod;
    }

    public void setWebUrl(String webUrl) {
        this.webUrl = webUrl;
    }

    public void setWebParameters(String webParameters) {
        this.webParameters = webParameters;
    }

    public void setWebSteps(String webSteps) {
        this.webSteps = webSteps;
    }

    public void setWebRequest(String webRequest) {
        this.webRequest = webRequest;
    }

    public void setWebResponse(String webResponse) {
        this.webResponse = webResponse;
    }


    public void setInvaded(Boolean invaded) {
        this.invaded = invaded;
    }

    public void setInvadedEnvironmentDescription(String invadedEnvironmentDescription) {
        this.invadedEnvironmentDescription = invadedEnvironmentDescription;
    }

    public void setVulnerabilityArchives(ArrayList<Evidence> vulnerabilityArchives) {
        this.vulnerabilityArchives = vulnerabilityArchives;
    }

    public void setNotification(boolean notification) {
        this.notification = notification;
    }




//    public HttpEntity toMultipart() throws FileNotFoundException {
//        if(this.notification){
//             return this.notificationToMultipart();
//        }else{
//            return this.vulnerabilityToMultipart();
//        }
//    }


    public ArrayList<Evidence> getVulnerabilityArchives() {
        return vulnerabilityArchives;
    }

    @Override
    public String toString() {
        return "Vulnerability{" +
                "project_id=" + analysisId +
                ", vulnerability_model_id=" + vulnerabilityTemplateId +
                ", impact='" + impact + '\'' +
                ", probability='" + probability + '\'' +
                ", client_impact='" + description + '\'' +
                ", impact_resume='" + impactResume + '\'' +
                ", web_protocol='" + webProtocol + '\'' +
                ", web_method='" + webMethod + '\'' +
                ", web_url='" + webUrl + '\'' +
                ", web_parameters='" + webParameters + '\'' +
                ", web_steps='" + webSteps + '\'' +
                ", web_request='" + webRequest + '\'' +
                ", web_response='" + webResponse + '\'' +
                ", invaded=" + invaded +
                ", invaded_environment_description='" + invadedEnvironmentDescription + '\'' +
                '}';
    }


}
