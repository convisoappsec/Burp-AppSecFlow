package view.new_vulnerability.custom.popup_menu;

import models.vulnerability.Evidence;
import view.new_vulnerability.NewVulnerabilityTab;

import javax.swing.*;
import javax.swing.filechooser.FileSystemView;
import java.io.File;

public class EvidencePopupMenu extends JPopupMenu {
    JMenuItem addEvidence;
    JMenuItem removeEvidence;
    NewVulnerabilityTab newVulnerabilityTab;


    public EvidencePopupMenu(NewVulnerabilityTab newVulnerabilityTab){//DefaultListModel<Evidence> evidenceListModel, JList evidenceList){
        this.newVulnerabilityTab = newVulnerabilityTab;

        addEvidence = new JMenuItem("Add");

        addEvidence.addActionListener(e -> new Thread(() -> {

            JFileChooser jFileChooser = new JFileChooser(FileSystemView.getFileSystemView().getDefaultDirectory());
            int returnValue = jFileChooser.showOpenDialog(this);

            if (returnValue == JFileChooser.APPROVE_OPTION) {
                File selectedFile = jFileChooser.getSelectedFile();
                Evidence evidence = new Evidence(selectedFile.getAbsolutePath(), selectedFile.getName());
                this.newVulnerabilityTab.addEvidence(evidence);
            }
        }).start());

        removeEvidence = new JMenuItem("Remove");

        removeEvidence.addActionListener(e -> new Thread(() -> {
            this.newVulnerabilityTab.removeSelectedEvidence();
        }).start());

        add(addEvidence);
        add(removeEvidence);

    }

}
